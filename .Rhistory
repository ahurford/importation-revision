geom_point(size = 4) +
geom_errorbarh(aes(xmin = LowerCI, xmax = UpperCI), height = 0.25, color = "darkgray") +
geom_vline(xintercept = 0, color = "black", linetype = "dashed", linewidth = 0.5) +
labs(
title = "PRCC with Confidence Intervals",
x = "Value",
y = "Parameter"
) +
theme_bw() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
axis.text = element_text(size = 11),
axis.title = element_text(size = 11)
)
plot_cum <- ggplot() +
geom_line(data = sort.output, aes(x=n, y=cum.prob))+
geom_point(data = quarts, aes(x = n, y = cprob), col="red")+
ylab("cumulative probability")+
annotate("text", x = quarts$n, y = quarts$cprob, label = round(quarts$n,0),hjust=0)+
ggtitle("Distribution of average estimates of n") +
theme_bw() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
axis.text = element_text(size = 11),
axis.title = element_text(size = 11)
)
print(plot_cum)
print(plot_prcc)
print(plot_P)
print(plot_a)
print(plot_R0)
# Combine the plots in a grid
(plot_R0) / (plot_a | plot_P) / (plot_prcc | plot_cum) +
plot_annotation(
title = "Parameter Distributions for Sampling",
theme = theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 16)
)
)
# # Combine the plots in a grid with plot_spacer for balance
# (plot_R0 | plot_psi) / (plot_a | plot_P) / (plot_prcc | plot_spacer()) +
#   plot_annotation(
#     title = "Parameter Distributions for Sampling",
#     theme = theme(
#       plot.title = element_text(hjust = 0.5, face = "bold", size = 16)
#     )
#   )
source("~/Desktop/Work/Students/MSc/Mack/Avian_influenza/Completed_plots/n_sensitivity_analysis_20250326_AH.R")
plot_cum <- ggplot() +
geom_line(data = sort.output, aes(x=log(n,10), y=cum.prob))+
geom_point(data = quarts, aes(x = log(n,10), y = cprob), col="red")+
ylab("cumulative probability")+
annotate("text", x = quarts$n, y = quarts$cprob, label = round(quarts$n,0),hjust=0)+
ggtitle("Distribution of average estimates of n") +
theme_bw() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
axis.text = element_text(size = 11),
axis.title = element_text(size = 11)
)
print(plot_cum)
print(plot_prcc)
print(plot_P)
print(plot_a)
print(plot_R0)
# Combine the plots in a grid
(plot_R0) / (plot_a | plot_P) / (plot_prcc | plot_cum) +
plot_annotation(
title = "Parameter Distributions for Sampling",
theme = theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 16)
)
)
# # Combine the plots in a grid with plot_spacer for balance
# (plot_R0 | plot_psi) / (plot_a | plot_P) / (plot_prcc | plot_spacer()) +
#   plot_annotation(
#     title = "Parameter Distributions for Sampling",
#     theme = theme(
#       plot.title = element_text(hjust = 0.5, face = "bold", size = 16)
#     )
#   )
plot_cum <- ggplot() +
geom_line(data = sort.output, aes(x=log(n,10), y=cum.prob))+
geom_point(data = quarts, aes(x = log(n,10), y = cprob), col="red")+
ylab("cumulative probability")+
annotate("text", x = log(quarts$n,10) y = quarts$cprob, label = round(quarts$n,0),hjust=0)+
plot_cum <- ggplot() +
geom_line(data = sort.output, aes(x=log(n,10), y=cum.prob))+
geom_point(data = quarts, aes(x = log(n,10), y = cprob), col="red")+
ylab("cumulative probability")+
annotate("text", x = log(quarts$n,10), y = quarts$cprob, label = round(quarts$n,0),hjust=0)+
ggtitle("Distribution of average estimates of n") +
theme_bw() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
axis.text = element_text(size = 11),
axis.title = element_text(size = 11)
)
print(plot_cum)
i5
sort.output = data.frame(n=sort(output))%>%mutate(cum.prob=cum.prob)
i025 = min(which(sort.output$cum.prob>=0.025))
i25 = min(which(sort.output$cum.prob>=0.25))
i50 = min(which(sort.output$cum.prob>=0.5))
i75 = min(which(sort.output$cum.prob>=0.75))
i975 = min(which(sort.output$cum.prob>=0.975))
# Quartiles:
quarts= data.frame(cprob = sort.output$cum.prob[i5], n=sort.output$n[i5])
quarts= rbind(quarts, data.frame(cprob = sort.output$cum.prob[i25], n=sort.output$n[i25]))
quarts= rbind(quarts, data.frame(cprob = sort.output$cum.prob[i50], n=sort.output$n[i50]))
quarts = rbind(quarts, data.frame(cprob = sort.output$cum.prob[i75], n=sort.output$n[i75]))
quarts = rbind(quarts, data.frame(cprob = sort.output$cum.prob[i95], n=sort.output$n[i95]))
quarts
quarts= data.frame(cprob = sort.output$cum.prob[i5], n=sort.output$n[i5])
quarts
plot_cum <- ggplot() +
geom_line(data = sort.output, aes(x=log(n,10), y=cum.prob))+
geom_point(data = quarts, aes(x = log(n,10), y = cprob), col="red")+
ylab("quantiles")+
annotate("text", x = log(quarts$n,10), y = quarts$cprob, label = round(quarts$n,0),hjust=0)+
ggtitle("Distribution of estimates of annual human infections") +
xlab("number of human infections, N (log 10)")
theme_bw() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
axis.text = element_text(size = 11),
axis.title = element_text(size = 11)
)
print(plot_cum)
i025 = min(which(sort.output$cum.prob>=0.025))
i25 = min(which(sort.output$cum.prob>=0.25))
i50 = min(which(sort.output$cum.prob>=0.5))
i75 = min(which(sort.output$cum.prob>=0.75))
i975 = min(which(sort.output$cum.prob>=0.975))
# Quartiles:
quarts= data.frame(cprob = sort.output$cum.prob[i025], n=sort.output$n[i025])
quarts= rbind(quarts, data.frame(cprob = sort.output$cum.prob[i25], n=sort.output$n[i25]))
quarts= rbind(quarts, data.frame(cprob = sort.output$cum.prob[i50], n=sort.output$n[i50]))
quarts = rbind(quarts, data.frame(cprob = sort.output$cum.prob[i75], n=sort.output$n[i75]))
quarts = rbind(quarts, data.frame(cprob = sort.output$cum.prob[i975], n=sort.output$n[i975]))
# Create individual distribution plots
plot_R0 <- ggplot(transformed_samples, aes(x = R0)) +
geom_histogram(bins = 30, fill = "steelblue", color = "black") +
labs(title = expression(R[0]), x = "Value", y = "Count") +
theme_bw()
plot_a <- ggplot(transformed_samples, aes(x = a)) +
geom_histogram(bins = 30, fill = "steelblue", color = "black") +
labs(title = expression(a), x = "Value", y = "Count") +
theme_bw()
plot_P <- ggplot(transformed_samples, aes(x = 1-1/Rstar)) +
geom_histogram(bins = 30, fill = "steelblue", color = "black") +
labs(title = "P", x = "Value", y = "Count") +
theme_bw()
plot_prcc <- ggplot(prcc_df, aes(x = PRCC, y = Parameter)) +
geom_point(size = 4) +
geom_errorbarh(aes(xmin = LowerCI, xmax = UpperCI), height = 0.25, color = "darkgray") +
geom_vline(xintercept = 0, color = "black", linetype = "dashed", linewidth = 0.5) +
labs(
title = "PRCC with Confidence Intervals",
x = "Value",
y = "Parameter"
) +
theme_bw() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
axis.text = element_text(size = 11),
axis.title = element_text(size = 11)
)
plot_cum <- ggplot() +
geom_line(data = sort.output, aes(x=log(n,10), y=cum.prob))+
geom_point(data = quarts, aes(x = log(n,10), y = cprob), col="red")+
ylab("quantiles")+
annotate("text", x = log(quarts$n,10), y = quarts$cprob, label = round(quarts$n,0),hjust=0)+
ggtitle("Distribution of estimates of annual human infections") +
xlab("number of human infections, N (log 10)")
theme_bw() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
axis.text = element_text(size = 11),
axis.title = element_text(size = 11)
)
print(plot_cum)
print(plot_prcc)
print(plot_P)
print(plot_a)
print(plot_R0)
# Combine the plots in a grid
(plot_R0) / (plot_a | plot_P) / (plot_prcc | plot_cum) +
plot_annotation(
title = "Parameter Distributions for Sampling",
theme = theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 16)
)
)
# # Combine the plots in a grid with plot_spacer for balance
# (plot_R0 | plot_psi) / (plot_a | plot_P) / (plot_prcc | plot_spacer()) +
#   plot_annotation(
#     title = "Parameter Distributions for Sampling",
#     theme = theme(
#       plot.title = element_text(hjust = 0.5, face = "bold", size = 16)
#     )
#   )
plot_cum <- ggplot() +
geom_line(data = sort.output, aes(x=log(n,10), y=cum.prob))+
geom_point(data = quarts, aes(x = log(n,10), y = cprob), col="red")+
ylab("quantiles")+
annotate("text", x = log(quarts$n,10), y = quarts$cprob, label = round(quarts$n,0),hjust=0)+
ggtitle("Distribution of estimates of annual human infections") +
xlab("number of human infections, N (log 10)")
theme_bw() +
scale_x_continuous(breaks=seq(0,5,1))+
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
axis.text = element_text(size = 11),
axis.title = element_text(size = 11)
)
plot_cum <- ggplot() +
geom_line(data = sort.output, aes(x=log(n,10), y=cum.prob))+
geom_point(data = quarts, aes(x = log(n,10), y = cprob), col="red")+
ylab("quantiles")+
annotate("text", x = log(quarts$n,10), y = quarts$cprob, label = round(quarts$n,0),hjust=0)+
ggtitle("Distribution of estimates of annual human infections") +
xlab("number of human infections, N (log 10)")+
theme_bw() +
scale_x_continuous(breaks=seq(0,5,1))+
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
axis.text = element_text(size = 11),
axis.title = element_text(size = 11)
)
print(plot_cum)
plot_cum <- ggplot() +
geom_line(data = sort.output, aes(x=log(n,10), y=cum.prob))+
geom_point(data = quarts, aes(x = log(n,10), y = cprob), col="red")+
ylab("quantiles")+
annotate("text", x = log(quarts$n,10), y = quarts$cprob, label = round(quarts$n,0),hjust=0)+
ggtitle("Distribution of estimates of annual human infections") +
xlab("number of human infections, N (log 10)")+
theme_bw() +
scale_x_continuous(breaks=seq(0,5,1))+
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
axis.text = element_text(size = 11),
axis.title = element_text(size = 11)
)
print(plot_cum)
print(plot_cum)
plot_cum <- ggplot() +
geom_line(data = sort.output, aes(x=log(n,10), y=cum.prob))+
geom_point(data = quarts, aes(x = log(n,10), y = cprob), col="red")+
ylab("quantiles")+
annotate("text", x = log(quarts$n,10), y = quarts$cprob, label = round(quarts$n,0),hjust=0)+
ggtitle("Distribution of estimates of annual human infections") +
xlab("number of human infections, N (log 10)")+
theme_bw() +
scale_x_continuous(breaks=seq(0,4,1))
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
axis.text = element_text(size = 11),
axis.title = element_text(size = 11)
)
plot_cum <- ggplot() +
geom_line(data = sort.output, aes(x=log(n,10), y=cum.prob))+
geom_point(data = quarts, aes(x = log(n,10), y = cprob), col="red")+
ylab("quantiles")+
annotate("text", x = log(quarts$n,10), y = quarts$cprob, label = round(quarts$n,0),hjust=0)+
ggtitle("Distribution of estimates of annual human infections") +
xlab("number of human infections, N (log 10)")+
theme_bw() +
scale_x_continuous(breaks=seq(0,4,1))+
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
axis.text = element_text(size = 11),
axis.title = element_text(size = 11)
)
print(plot_cum)
plot_cum <- ggplot() +
geom_line(data = sort.output, aes(x=log(n,10), y=cum.prob))+
geom_point(data = quarts, aes(x = log(n,10), y = cprob), col="red")+
ylab("quantiles")+
annotate("text", x = log(quarts$n,10), y = quarts$cprob, label = round(quarts$n,0),hjust=0)+
ggtitle("Distribution of estimates of annual human infections") +
xlab("number of human infections, N (log 10)")+
theme_bw() +
scale_x_continuous(breaks=seq(0,4,1),xlim=c(0,4))+
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
axis.text = element_text(size = 11),
axis.title = element_text(size = 11)
)
plot_cum <- ggplot() +
geom_line(data = sort.output, aes(x=log(n,10), y=cum.prob))+
geom_point(data = quarts, aes(x = log(n,10), y = cprob), col="red")+
ylab("quantiles")+
annotate("text", x = log(quarts$n,10), y = quarts$cprob, label = round(quarts$n,0),hjust=0)+
ggtitle("Distribution of estimates of annual human infections") +
xlab("number of human infections, N (log 10)")+
theme_bw() +
xlim(c(0,4))+
scale_x_continuous(breaks=seq(0,4,1))+
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
axis.text = element_text(size = 11),
axis.title = element_text(size = 11)
)
plot_cum <- ggplot() +
geom_line(data = sort.output, aes(x=log(n,10), y=cum.prob))+
geom_point(data = quarts, aes(x = log(n,10), y = cprob), col="red")+
ylab("quantiles")+
annotate("text", x = log(quarts$n,10), y = quarts$cprob, label = round(quarts$n,0),hjust=0)+
ggtitle("Distribution of estimates of annual human infections") +
xlab("number of human infections, N (log 10)")+
theme_bw() +
scale_x_continuous(breaks=seq(0,4,1),xlim=c(0,4))+
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
axis.text = element_text(size = 11),
axis.title = element_text(size = 11)
)
plot_cum <- ggplot() +
geom_line(data = sort.output, aes(x=log(n,10), y=cum.prob))+
geom_point(data = quarts, aes(x = log(n,10), y = cprob), col="red")+
ylab("quantiles")+
annotate("text", x = log(quarts$n,10), y = quarts$cprob, label = round(quarts$n,0),hjust=0)+
ggtitle("Distribution of estimates of annual human infections") +
xlab("number of human infections, N (log 10)")+
theme_bw() +
scale_x_continuous(breaks=seq(0,4,1),xlim=c(0,4))+
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
axis.text = element_text(size = 11),
axis.title = element_text(size = 11)
)
print(plot_cum)
plot_cum <- ggplot() +
geom_line(data = sort.output, aes(x=log(n,10), y=cum.prob))+
geom_point(data = quarts, aes(x = log(n,10), y = cprob), col="red")+
ylab("quantiles")+
annotate("text", x = log(quarts$n,10), y = quarts$cprob, label = round(quarts$n,0),hjust=0)+
ggtitle("Distribution of estimates of annual human infections") +
xlab("number of human infections, N (log 10)")+
theme_bw() +
scale_x_continuous(breaks=seq(0,4,1),xlim=c(0,4))+
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
axis.text = element_text(size = 11),
axis.title = element_text(size = 11)
)
plot_cum <- ggplot() +
geom_line(data = sort.output, aes(x=log(n,10), y=cum.prob))+
geom_point(data = quarts, aes(x = log(n,10), y = cprob), col="red")+
ylab("quantiles")+
annotate("text", x = log(quarts$n,10), y = quarts$cprob, label = round(quarts$n,0),hjust=0)+
ggtitle("Distribution of estimates of annual human infections") +
xlab("number of human infections, N (log 10)")+
theme_bw() +
xlim(c(0,4))+
scale_x_continuous(breaks=seq(0,4,1))+
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
axis.text = element_text(size = 11),
axis.title = element_text(size = 11)
)
plot_cum
plot_cum
plot_cum <- ggplot() +
geom_line(data = sort.output, aes(x=log(n,10), y=cum.prob))+
geom_point(data = quarts, aes(x = log(n,10), y = cprob), col="red")+
ylab("quantiles")+
annotate("text", x = log(quarts$n,10), y = quarts$cprob, label = round(quarts$n,0),hjust=0)+
ggtitle("Distribution of estimates of annual human infections") +
xlab("number of human infections, N (log 10)")+
theme_bw() +
scale_x_continuous(breaks=seq(0,4,.5))+
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
axis.text = element_text(size = 11),
axis.title = element_text(size = 11)
)
print(plot_cum)
plot_cum <- ggplot() +
geom_line(data = sort.output, aes(x=log(n,10), y=cum.prob))+
geom_point(data = quarts, aes(x = log(n,10), y = cprob), col="red")+
ylab("quantiles")+
annotate("text", x = log(quarts$n,10), y = quarts$cprob, label = round(quarts$n,0),hjust=0)+
ggtitle("Distribution of estimates of annual human infections") +
xlab("number of human infections, N (log 10)")+
theme_bw() +
scale_x_continuous(breaks=seq(0,4))+
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
axis.text = element_text(size = 11),
axis.title = element_text(size = 11)
)
plot_cum
plot_cum <- ggplot() +
geom_line(data = sort.output, aes(x=log(n,10), y=cum.prob))+
geom_point(data = quarts, aes(x = log(n,10), y = cprob), col="red")+
ylab("quantiles")+
annotate("text", x = log(quarts$n,10), y = quarts$cprob, label = round(quarts$n,0),hjust=0)+
ggtitle("Distribution of estimates of annual human infections") +
xlab("number of human infections, N (log 10)")+
theme_bw() +
xlim(c(2,4))+
scale_x_continuous(breaks=seq(0,4))+
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
axis.text = element_text(size = 11),
axis.title = element_text(size = 11)
)
plot_cum
plot_cum <- ggplot() +
geom_line(data = sort.output, aes(x=log(n,10), y=cum.prob))+
geom_point(data = quarts, aes(x = log(n,10), y = cprob), col="red")+
ylab("quantiles")+
annotate("text", x = log(quarts$n,10), y = quarts$cprob, label = round(quarts$n,0),hjust=0)+
annotate("text", x = 10, y = 0, label = "")+
ggtitle("Distribution of estimates of annual human infections") +
xlab("number of human infections, N (log 10)")+
theme_bw() +
xlim(c(2,4))+
scale_x_continuous(breaks=seq(0,5))+
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
axis.text = element_text(size = 11),
axis.title = element_text(size = 11)
)
plot_cum <- ggplot() +
geom_line(data = sort.output, aes(x=log(n,10), y=cum.prob))+
geom_point(data = quarts, aes(x = log(n,10), y = cprob), col="red")+
ylab("quantiles")+
annotate("text", x = log(quarts$n,10), y = quarts$cprob, label = round(quarts$n,0),hjust=0)+
annotate("text", x = 10, y = 0, label = "")+
ggtitle("Distribution of estimates of annual human infections") +
xlab("number of human infections, N (log 10)")+
theme_bw() +
scale_x_continuous(breaks=seq(0,5))+
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
axis.text = element_text(size = 11),
axis.title = element_text(size = 11)
)
print(plot_cum)
plot_cum <- ggplot() +
geom_line(data = sort.output, aes(x=log(n,10), y=cum.prob))+
geom_point(data = quarts, aes(x = log(n,10), y = cprob), col="red")+
ylab("quantiles")+
annotate("text", x = log(quarts$n,10), y = quarts$cprob, label = round(quarts$n,0),hjust=0)+
annotate("text", x = c(1,5), y = c(0,0), label = "")+
ggtitle("Distribution of estimates of annual human infections") +
xlab("number of human infections, N (log 10)")+
theme_bw() +
scale_x_continuous(breaks=seq(0,5))+
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
axis.text = element_text(size = 11),
axis.title = element_text(size = 11)
)
print(plot_cum)
plot_cum <- ggplot() +
geom_line(data = sort.output, aes(x=log(n,10), y=cum.prob))+
geom_point(data = quarts, aes(x = log(n,10), y = cprob), col="red")+
ylab("quantiles")+
annotate("text", x = log(quarts$n,10), y = quarts$cprob, label = round(quarts$n,0),hjust=0)+
annotate("text", x = c(2,5), y = c(0,0), label = "")+
ggtitle("Distribution of estimates of annual human infections") +
xlab("number of human infections, N (log 10)")+
theme_bw() +
scale_x_continuous(breaks=seq(0,5))+
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
axis.text = element_text(size = 11),
axis.title = element_text(size = 11)
)
print(plot_cum)
plot_cum <- ggplot() +
geom_line(data = sort.output, aes(x=log(n,10), y=cum.prob))+
geom_point(data = quarts, aes(x = log(n,10), y = cprob), col="red")+
ylab("quantiles")+
annotate("text", x = log(quarts$n,10), y = quarts$cprob, label = round(quarts$n,0),hjust=0)+
annotate("text", x =2, y = 0, label = "")+ #blank label to force x-axis to start at 2
ggtitle("Distribution of estimates of annual human infections") +
xlab("number of human infections, N (log 10)")+
theme_bw() +
scale_x_continuous(breaks=seq(0,5))+
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
axis.text = element_text(size = 11),
axis.title = element_text(size = 11)
)
print(plot_cum)
plot_cum <- ggplot() +
geom_line(data = sort.output, aes(x=log(n,10), y=cum.prob))+
geom_point(data = quarts, aes(x = log(n,10), y = cprob), col="red")+
ylab("quantiles")+
annotate("text", x = log(quarts$n,10), y = quarts$cprob, label = round(quarts$n,0),hjust=0)+
annotate("text", x =2, y = 0, label = "")+ #blank label to force x-axis to start at 2
ggtitle("Distribution of estimates of annual human infections") +
xlab("number of human infections, N")+
theme_bw() +
scale_x_continuous(breaks=seq(2,4),labels = c(100,1000,10000))+
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
axis.text = element_text(size = 11),
axis.title = element_text(size = 11)
)
print(plot_cum)
source("~/Desktop/Work/Research/Research_Projects/2025/importation-revision/getcases.pro.R")
setwed("~/Desktop/Work/Research/Research_Projects/2025/importation-revision/")
setwd("~/Desktop/Work/Research/Research_Projects/2025/importation-revision/")
source("~/Desktop/Work/Research/Research_Projects/2025/importation-revision/getcases.pro.R")
source("~/Desktop/Work/Research/Research_Projects/2025/importation-revision/preliminaries.R")
